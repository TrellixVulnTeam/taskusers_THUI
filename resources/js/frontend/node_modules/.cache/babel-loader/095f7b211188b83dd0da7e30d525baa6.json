{"ast":null,"code":"import _objectSpread from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import'./UserRegister.scss';import React,{Component,Fragment,createRef}from'react';import Main from'../templates/Main';import axios from'axios';import Toast from'../utils/Toast';import baseUrl from'../../config/baseUrl';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var baseUrlBackend=\"\".concat(baseUrl.baseUrlBackend);var headerProps={icon:'user',title:'Registro de Usuário',subtitle:'Preencha o formulário abaixo para cadastrar um usuário.'};var UserRegister=/*#__PURE__*/function(_Component){_inherits(UserRegister,_Component);var _super=_createSuper(UserRegister);function UserRegister(props){var _this;_classCallCheck(this,UserRegister);_this=_super.call(this,props);_this.newToast=function(message){_this.setState({toastMessage:message},function(){_this.child.current.show();});};_this.child=/*#__PURE__*/createRef();_this.state={name:props.name||'',username:props.username||'',password:props.password||'',repeat_password:'',toastMessage:'false',errorForm:[],formRegister:{name:{label:\"Nome:\",inputName:\"name\",maxLength:85},username:{label:\"Usuário:\",inputName:\"username\",maxLength:20},password:{label:\"Senha:\",inputName:\"password\",maxLength:150},repeat_password:{label:\"Repita a senha:\",inputName:\"repeat_password\",maxLength:150},submitButton:\"Cadastrar\"}};_this.handleNameChange=_this.handleNameChange.bind(_assertThisInitialized(_this));_this.handleUsernameChange=_this.handleUsernameChange.bind(_assertThisInitialized(_this));_this.handlePasswordChange=_this.handlePasswordChange.bind(_assertThisInitialized(_this));_this.handleRepeatPasswordChange=_this.handleRepeatPasswordChange.bind(_assertThisInitialized(_this));return _this;}_createClass(UserRegister,[{key:\"isValidUser\",value:function isValidUser(){var _this$state=this.state,name=_this$state.name,username=_this$state.username,password=_this$state.password,repeat_password=_this$state.repeat_password;var validate={errors:[]};if(!name||name==''){validate.errors.push('O nome precisa ser preenchido.');}if(name&&name!=''){if(name.length<3||name.length>85){validate.errors.push('O nome precisa ter de 3-85 caracteres.');}}if(!username||username==''){validate.errors.push('O nome de usuário precisa ser preenchido.');}if(username&&username!=''){if(username.length<4||username.length>20){validate.errors.push('O usuário precisa ter de 4-20 caracteres.');}}if(!password||password==''){validate.errors.push('A senha precisa ser preenchida.');}if(!repeat_password||repeat_password==''){validate.errors.push('O campo repita a senha precisa ser preenchido.');}if(password&&password!=''){if(password.length<8){validate.errors.push('A senha precisa ser ao menos 8 caracteres.');}if(password.length>149){validate.errors.push('A senha precisa ser menor que 150 caracteres.');}}if(repeat_password&&repeat_password!=''&&password&&password!=''){if(password!==repeat_password){validate.errors.push('As senhas digitadas precisam ser iguais');}}if(validate.errors.length>0){this.setState({errorForm:validate.errors});return false;}else{this.setState({errorForm:[]});return true;}}},{key:\"handleSubmit\",value:function handleSubmit(e){var _this2=this;e.preventDefault();if(this.isValidUser()){var user={name:this.state.name,username:this.state.username,password:this.state.password,is_active:1};console.log(\"\".concat(baseUrlBackend,\"/add/user\"));axios.post(\"\".concat(baseUrlBackend,\"/add/user\"),user).then(function(response){if(response){console.log(response);_this2.newToast(\"Usuário cadastrado com sucesso!\");window.location.href=\"/listar-usuarios\";}}).catch(function(err){console.log(err.response.status);switch(err.response.status){case 409:_this2.newToast(\"Usuário já possui cadastro!\");break;default:_this2.newToast(\"Ocorreu um erro com o servidor, tente novamente mais tarde.\");}});}else{if(!this.state.name&&!this.state.username&&!this.state.password&&!this.state.repeat_password){this.newToast(\"Todos os campos devem ser preenchidos.\");}else{this.newToast(\"Existem campos inválidos.\");}}}},{key:\"messageError\",value:function messageError(){var errorForm=this.state.errorForm;if(errorForm.length>0){console.log('entrei...');return/*#__PURE__*/_jsx(\"div\",{className:\"errors\",children:errorForm.map(function(error){/*#__PURE__*/_jsxs(\"li\",{children:[\"-\",error]},error);})});}}},{key:\"handleNameChange\",value:function handleNameChange(event){this.setState({name:event.target.value});}},{key:\"handleUsernameChange\",value:function handleUsernameChange(event){this.setState({username:event.target.value});}},{key:\"handlePasswordChange\",value:function handlePasswordChange(event){this.setState({password:event.target.value});}},{key:\"handleRepeatPasswordChange\",value:function handleRepeatPasswordChange(event){this.setState({repeat_password:event.target.value});}},{key:\"render\",value:function render(){var _this3=this;var _this$state2=this.state,formRegister=_this$state2.formRegister,name=_this$state2.name,username=_this$state2.username,password=_this$state2.password,repeat_password=_this$state2.repeat_password;var messError=this.messageError();return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(Main,_objectSpread(_objectSpread({},headerProps),{},{children:[/*#__PURE__*/_jsx(Toast,{message:this.state.toastMessage,time:3000,ref:this.child}),/*#__PURE__*/_jsxs(\"form\",{children:[messError,/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{children:formRegister.name.label}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handleNameChange,id:formRegister.name.inputName,name:formRegister.name.inputName,type:\"text\",value:name,maxLength:formRegister.name.maxLength})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{children:formRegister.username.label}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handleUsernameChange,id:formRegister.username.inputName,name:formRegister.username.inputName,type:\"text\",value:username,maxLength:formRegister.username.maxLength})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{children:formRegister.password.label}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handlePasswordChange,id:formRegister.password.inputName,name:formRegister.password.inputName,type:\"password\",value:password,maxLength:formRegister.password.maxLength})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{children:formRegister.repeat_password.label}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handleRepeatPasswordChange,id:formRegister.repeat_password.inputName,name:formRegister.repeat_password.inputName,type:\"password\",value:repeat_password,maxLength:formRegister.repeat_password.maxLength})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex  flex-row-reverse\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return _this3.handleSubmit(e);},children:formRegister.submitButton})})]})]}))});}}]);return UserRegister;}(Component);export{UserRegister as default};","map":{"version":3,"sources":["/home/ivanferrer/projetos/taskusers/resources/js/frontend/task-users/src/components/registers/UserRegister.jsx"],"names":["React","Component","Fragment","createRef","Main","axios","Toast","baseUrl","baseUrlBackend","headerProps","icon","title","subtitle","UserRegister","props","newToast","message","setState","toastMessage","child","current","show","state","name","username","password","repeat_password","errorForm","formRegister","label","inputName","maxLength","submitButton","handleNameChange","bind","handleUsernameChange","handlePasswordChange","handleRepeatPasswordChange","validate","errors","push","length","e","preventDefault","isValidUser","user","is_active","console","log","post","then","response","window","location","href","catch","err","status","map","error","event","target","value","messError","messageError","handleSubmit"],"mappings":"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","sourcesContent":["import './UserRegister.scss'\nimport React, {Component, Fragment, createRef} from 'react'\nimport Main from '../templates/Main'\nimport axios from 'axios'\nimport Toast from '../utils/Toast';\nimport baseUrl from '../../config/baseUrl'\n\nconst baseUrlBackend = `${baseUrl.baseUrlBackend}`\n\nconst headerProps = {\n    icon: 'user',\n    title: 'Registro de Usuário',\n    subtitle: 'Preencha o formulário abaixo para cadastrar um usuário.',\n}\n\nexport default class UserRegister extends Component {\n    constructor(props) {\n        super(props)\n\n        this.child = createRef()\n\n        this.state = {\n            name: props.name || '',\n            username: props.username || '',\n            password: props.password || '',\n            repeat_password:'',\n            toastMessage:'false',\n            errorForm:[],\n            formRegister:{\n                name:{\n                    label:\"Nome:\",\n                    inputName:\"name\",\n                    maxLength:85\n                },\n                username:{\n                    label:\"Usuário:\",\n                    inputName:\"username\",\n                    maxLength:20\n                },\n                password:{\n                    label:\"Senha:\",\n                    inputName:\"password\",\n                    maxLength:150\n                },\n                repeat_password:{\n                    label:\"Repita a senha:\",\n                    inputName:\"repeat_password\",\n                    maxLength:150\n                },\n                submitButton:\"Cadastrar\"\n\n            }\n        }\n        this.handleNameChange = this.handleNameChange.bind(this)\n        this.handleUsernameChange = this.handleUsernameChange.bind(this)\n        this.handlePasswordChange = this.handlePasswordChange.bind(this)\n        this.handleRepeatPasswordChange = this.handleRepeatPasswordChange.bind(this)\n\n    }\n\n    isValidUser() {\n        const {name, username, password, repeat_password} = this.state\n\n        const validate = {\n            errors:[]\n        }\n\n        if (!name || name == '') {\n            validate.errors.push('O nome precisa ser preenchido.');\n        }\n        if (name && name != '') {\n            if(name.length < 3 || name.length > 85) {\n                validate.errors.push('O nome precisa ter de 3-85 caracteres.');\n            }\n        }\n        if (!username || username == '') {\n            validate.errors.push('O nome de usuário precisa ser preenchido.');\n        }\n        if (username && username != '') {\n            if (username.length < 4 || username.length > 20) {\n                validate.errors.push('O usuário precisa ter de 4-20 caracteres.');\n            }\n        }\n        if (!password || password == '') {\n            validate.errors.push('A senha precisa ser preenchida.');\n        }\n        if (!repeat_password || repeat_password == '') {\n            validate.errors.push('O campo repita a senha precisa ser preenchido.');\n        }\n        if (password && password != '') {\n            if (password.length < 8) {\n                validate.errors.push('A senha precisa ser ao menos 8 caracteres.');\n            }\n            if (password.length > 149) {\n                validate.errors.push('A senha precisa ser menor que 150 caracteres.');\n            }\n        }\n        if (repeat_password && repeat_password != '' && password && password != '') {\n            if (password !== repeat_password) {\n               validate.errors.push('As senhas digitadas precisam ser iguais');\n            }\n        }\n        if (validate.errors.length > 0) {\n            this.setState({errorForm:validate.errors})\n            return false\n        } else {\n            this.setState({errorForm:[]})\n            return true;\n        }\n    }\n\n    handleSubmit(e) {\n        e.preventDefault()\n        if (this.isValidUser()) {\n\n            let user = {\n                name:this.state.name,\n                username:this.state.username,\n                password:this.state.password,\n                is_active:1\n            }\n            console.log(`${baseUrlBackend}/add/user`)\n            axios.post(`${baseUrlBackend}/add/user`, user)\n            .then(response => {\n                if(response) {\n                    console.log(response)\n                    this.newToast(\"Usuário cadastrado com sucesso!\")\n                    window.location.href = \"/listar-usuarios\"\n                }\n            }).catch(err => {\n                console.log(err.response.status)\n                switch(err.response.status){\n                    case 409: \n                        this.newToast(\"Usuário já possui cadastro!\");\n                    break\n                    default:  \n                          this.newToast(\"Ocorreu um erro com o servidor, tente novamente mais tarde.\")\n                }\n            })\n        } else {\n            if (!this.state.name && !this.state.username && !this.state.password && !this.state.repeat_password ) {\n                this.newToast(\"Todos os campos devem ser preenchidos.\")\n            } else {\n                this.newToast(\"Existem campos inválidos.\")\n            }\n        }\n\n    }\n\n    messageError() {\n       \n        const { errorForm } = this.state\n        if (errorForm.length > 0) {\n            console.log('entrei...')\n          return (<div className=\"errors\">\n                    {errorForm.map((error) => {\n                        <li key={error}>-{error}</li>\n                    })}\n                 </div>)\n        }\n    }\n\n    newToast = (message) => {\n        this.setState({toastMessage:message}, () => {\n            this.child.current.show()\n        })\n    }\n\n    handleNameChange(event) {\n        this.setState({\n            name:event.target.value\n        })\n    }\n\n    handleUsernameChange(event) {\n        this.setState({\n            username:event.target.value\n        })\n    }\n\n    handlePasswordChange(event) {\n        this.setState({\n            password:event.target.value\n        })\n    }\n\n    handleRepeatPasswordChange(event) {\n        this.setState({\n            repeat_password:event.target.value\n        })\n    }\n\n    render() {\n\n        const { formRegister, name, username, password, repeat_password } = this.state\n\n        const messError = this.messageError()\n\n        return (\n              \n            <Fragment>\n                <Main {...headerProps}>\n                <Toast message={this.state.toastMessage} time={3000} ref={this.child}/>\n                    <form>\n                        {messError}\n                        <div className=\"form-control\">\n                            <label>{formRegister.name.label}</label>\n                            <input onChange={this.handleNameChange} id={formRegister.name.inputName} name={formRegister.name.inputName} type=\"text\" value={name} maxLength={formRegister.name.maxLength} />\n                        </div>\n                        <div className=\"form-control\">\n                            <label>{formRegister.username.label}</label>\n                            <input onChange={this.handleUsernameChange} id={formRegister.username.inputName} name={formRegister.username.inputName} type=\"text\" value={username} maxLength={formRegister.username.maxLength} />\n                        </div>\n                        <div className=\"form-control\">\n                            <label>{formRegister.password.label}</label>\n                            <input onChange={this.handlePasswordChange} id={formRegister.password.inputName} name={formRegister.password.inputName} type=\"password\" value={password} maxLength={formRegister.password.maxLength} />\n                        </div>\n                        <div className=\"form-control\">\n                            <label>{formRegister.repeat_password.label}</label>\n                            <input onChange={this.handleRepeatPasswordChange} id={formRegister.repeat_password.inputName} name={formRegister.repeat_password.inputName} type=\"password\" value={repeat_password} maxLength={formRegister.repeat_password.maxLength} />\n                        </div>\n                        <div className=\"d-flex  flex-row-reverse\">\n                            <button onClick={e=>this.handleSubmit(e)}>{formRegister.submitButton}</button>\n                        </div>\n                    </form>\n                </Main>\n            </Fragment>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}